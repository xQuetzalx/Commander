<!DOCTYPE html>

<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Commander Arena</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

```
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: linear-gradient(135deg, #0f0a1e 0%, #2d1b4e 50%, #0f0a1e 100%);
  color: white;
  min-height: 100vh;
  overflow-x: hidden;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

.header {
  background: rgba(0, 0, 0, 0.4);
  border-bottom: 1px solid rgba(139, 92, 246, 0.2);
  padding: 30px 20px;
  margin-bottom: 30px;
}

.title {
  font-size: 36px;
  font-weight: bold;
  background: linear-gradient(to right, #c4b5fd, #f0abfc, #c4b5fd);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 10px;
}

.subtitle {
  color: rgba(196, 181, 253, 0.7);
  font-size: 14px;
}

.card {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(139, 92, 246, 0.2);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 20px;
}

.button {
  background: linear-gradient(to right, #7c3aed, #c026d3);
  color: white;
  border: none;
  border-radius: 12px;
  padding: 16px 24px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 12px;
  transition: transform 0.2s;
}

.button:active {
  transform: scale(0.98);
}

.button-secondary {
  background: rgba(100, 100, 100, 0.3);
}

.button-danger {
  background: rgba(239, 68, 68, 0.2);
  border: 1px solid rgba(239, 68, 68, 0.3);
  color: #fca5a5;
}

.input {
  width: 100%;
  background: rgba(15, 23, 42, 0.5);
  border: 1px solid rgba(139, 92, 246, 0.3);
  border-radius: 12px;
  padding: 12px 16px;
  color: white;
  font-size: 16px;
}

.input::placeholder {
  color: rgba(196, 181, 253, 0.4);
}

.input:focus {
  outline: none;
  border-color: #8b5cf6;
}

.modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
  z-index: 1000;
}

.modal-content {
  background: #1e1b4b;
  border: 1px solid rgba(139, 92, 246, 0.3);
  border-radius: 16px;
  max-width: 600px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
}

.modal-header {
  padding: 20px;
  border-bottom: 1px solid rgba(139, 92, 246, 0.2);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.modal-body {
  padding: 20px;
}

.modal-footer {
  padding: 20px;
  border-top: 1px solid rgba(139, 92, 246, 0.2);
  display: flex;
  gap: 12px;
}

textarea {
  width: 100%;
  min-height: 300px;
  background: rgba(15, 23, 42, 0.5);
  border: 1px solid rgba(139, 92, 246, 0.3);
  border-radius: 12px;
  padding: 12px;
  color: white;
  font-family: monospace;
  font-size: 14px;
  resize: vertical;
}

.deck-item {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(139, 92, 246, 0.2);
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 12px;
}

.deck-title {
  font-size: 20px;
  font-weight: bold;
  margin-bottom: 8px;
}

.deck-info {
  color: rgba(196, 181, 253, 0.6);
  font-size: 14px;
  margin-bottom: 12px;
}

.player-card {
  background: rgba(255, 255, 255, 0.05);
  border: 2px solid rgba(139, 92, 246, 0.2);
  border-radius: 16px;
  padding: 20px;
  margin-bottom: 16px;
}

.life-counter {
  font-size: 48px;
  font-weight: bold;
  text-align: center;
  margin: 20px 0;
}

.counter-buttons {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 8px;
  margin-top: 12px;
}

.counter-btn {
  padding: 12px;
  border-radius: 8px;
  border: 1px solid;
  font-weight: bold;
  cursor: pointer;
}

.btn-minus {
  background: rgba(239, 68, 68, 0.2);
  border-color: rgba(239, 68, 68, 0.3);
  color: #fca5a5;
}

.btn-plus {
  background: rgba(34, 197, 94, 0.2);
  border-color: rgba(34, 197, 94, 0.3);
  color: #86efac;
}

.back-btn {
  background: none;
  border: none;
  color: #c4b5fd;
  font-size: 24px;
  cursor: pointer;
  padding: 8px;
}

.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 12px;
  padding: 20px;
}

.card-image {
  width: 100%;
  border-radius: 12px;
  cursor: pointer;
  transition: transform 0.2s;
}

.card-image:hover {
  transform: scale(1.05);
}

.loading {
  text-align: center;
  padding: 40px;
  font-size: 18px;
  color: #c4b5fd;
}

.empty-state {
  text-align: center;
  padding: 60px 20px;
  color: rgba(196, 181, 253, 0.7);
}

.hidden {
  display: none !important;
}

.label {
  display: block;
  color: #c4b5fd;
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 8px;
}

.error {
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.3);
  border-radius: 8px;
  padding: 12px;
  color: #fca5a5;
  margin-top: 12px;
}

.toolbar {
  background: rgba(0, 0, 0, 0.4);
  border-bottom: 1px solid rgba(139, 92, 246, 0.2);
  padding: 16px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  z-index: 100;
}

.toolbar-title {
  font-size: 20px;
  font-weight: bold;
}

.icon-btn {
  background: none;
  border: none;
  color: #c4b5fd;
  font-size: 20px;
  cursor: pointer;
  padding: 8px;
}

.flex {
  display: flex;
  gap: 12px;
}

.flex-between {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
```

  </style>
</head>
<body>
  <div id="app">
    <div class="loading">Cargando Commander Arena...</div>
  </div>

  <script type="module">
    import React, { useState, useEffect } from 'https://esm.sh/react@18.2.0';
    import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';

    function App() {
      const [view, setView] = useState('home');
      const [decks, setDecks] = useState([]);
      const [name, setName] = useState('');
      const [showImport, setShowImport] = useState(false);
      const [importText, setImportText] = useState('');
      const [error, setError] = useState('');
      const [game, setGame] = useState(null);
      const [cards, setCards] = useState([]);
      const [loading, setLoading] = useState(false);
      const [selectedCard, setSelectedCard] = useState(null);

      useEffect(() => {
        const saved = localStorage.getItem('mtg-decks');
        if (saved) setDecks(JSON.parse(saved));
        const savedName = localStorage.getItem('mtg-name');
        if (savedName) setName(savedName);
      }, []);

      const saveName = (n) => {
        setName(n);
        localStorage.setItem('mtg-name', n);
      };

      const saveDecks = (d) => {
        setDecks(d);
        localStorage.setItem('mtg-decks', JSON.stringify(d));
      };

      const importDeck = () => {
        setError('');
        const lines = importText.split('\\n').filter(l => l.trim());
        const cards = [];
        let deckName = 'Mazo ' + new Date().toLocaleDateString();
        
        for (let line of lines) {
          if (line.match(/^Deck:/i)) {
            deckName = line.split(':')[1].trim();
            continue;
          }
          const m = line.match(/^(\\d+)x?\\s+(.+?)(?:\\s+\\([^)]+\\))?$/);
          if (m) {
            cards.push({ name: m[2].trim(), qty: parseInt(m[1]) });
          }
        }
        
        if (cards.length > 0) {
          saveDecks([...decks, {
            id: Date.now() + '',
            name: deckName,
            cards,
            total: cards.reduce((s, c) => s + c.qty, 0)
          }]);
          setImportText('');
          setShowImport(false);
        } else {
          setError('No se encontraron cartas');
        }
      };

      const deleteDeck = (id) => {
        if (confirm('Â¿Eliminar mazo?')) {
          saveDecks(decks.filter(d => d.id !== id));
        }
      };

      const startGame = (deck) => {
        if (!name) {
          alert('Introduce tu nombre');
          return;
        }
        const gid = 'g' + Date.now();
        const g = {
          id: gid,
          players: [{
            id: '1',
            name,
            life: 40,
            cmdDmg: {},
            poison: 0,
            deck,
            color: '#8b5cf6'
          }],
          turn: 1
        };
        localStorage.setItem(gid, JSON.stringify(g));
        setGame(g);
        setView('game');
      };

      const updateLife = (pid, amt) => {
        const g = {
          ...game,
          players: game.players.map(p => 
            p.id === pid ? {...p, life: Math.max(0, p.life + amt)} : p
          )
        };
        localStorage.setItem(game.id, JSON.stringify(g));
        setGame(g);
      };

      const searchCards = async () => {
        setLoading(true);
        try {
          const res = await fetch('https://api.scryfall.com/cards/search?q=format:commander&order=edhrec');
          const data = await res.json();
          setCards(data.data || []);
        } catch (e) {}
        setLoading(false);
      };

      // HOME VIEW
      if (view === 'home') {
        return React.createElement('div', null,
          React.createElement('div', { className: 'header' },
            React.createElement('div', { className: 'title' }, 'ðŸ‘‘ Commander Arena'),
            React.createElement('div', { className: 'subtitle' }, 'Juega Commander online')
          ),
          React.createElement('div', { className: 'container' },
            React.createElement('div', { className: 'card' },
              React.createElement('label', { className: 'label' }, 'Tu Nombre'),
              React.createElement('input', {
                className: 'input',
                value: name,
                onChange: (e) => saveName(e.target.value),
                placeholder: 'Introduce tu nombre...'
              })
            ),
            React.createElement('button', {
              className: 'button',
              onClick: () => { setView('cards'); searchCards(); }
            }, 'âœ¨ Explorar Cartas'),
            React.createElement('button', {
              className: 'button',
              onClick: () => setView('decks')
            }, 'ðŸ“š Mis Mazos (' + decks.length + ')'),
            React.createElement('div', { className: 'card' },
              React.createElement('p', { style: { color: 'rgba(196, 181, 253, 0.7)', fontSize: '14px' } },
                'App autÃ³noma para jugar Magic Commander. Importa mazos desde Moxfield y juega con amigos.'
              )
            )
          )
        );
      }

      // CARDS VIEW
      if (view === 'cards') {
        return React.createElement('div', null,
          React.createElement('div', { className: 'toolbar' },
            React.createElement('button', {
              className: 'back-btn',
              onClick: () => setView('home')
            }, 'â†'),
            React.createElement('div', { className: 'toolbar-title' }, 'Explorar Cartas')
          ),
          loading ? React.createElement('div', { className: 'loading' }, 'Cargando...') :
            React.createElement('div', { className: 'card-grid' },
              cards.map(c => React.createElement('img', {
                key: c.id,
                className: 'card-image',
                src: c.image_uris?.normal || c.card_faces?.[0]?.image_uris?.normal,
                alt: c.name,
                onClick: () => setSelectedCard(c)
              }))
            ),
          selectedCard && React.createElement('div', {
            className: 'modal',
            onClick: () => setSelectedCard(null)
          },
            React.createElement('img', {
              src: selectedCard.image_uris?.large || selectedCard.image_uris?.normal,
              style: { maxWidth: '100%', maxHeight: '90vh', borderRadius: '12px' },
              onClick: (e) => e.stopPropagation()
            })
          )
        );
      }

      // DECKS VIEW
      if (view === 'decks') {
        return React.createElement('div', null,
          React.createElement('div', { className: 'toolbar' },
            React.createElement('button', {
              className: 'back-btn',
              onClick: () => setView('home')
            }, 'â†'),
            React.createElement('div', { className: 'toolbar-title' }, 'Mis Mazos'),
            React.createElement('button', {
              className: 'icon-btn',
              onClick: () => setShowImport(true)
            }, '+')
          ),
          React.createElement('div', { className: 'container' },
            decks.length === 0 ?
              React.createElement('div', { className: 'empty-state' },
                React.createElement('div', { style: { fontSize: '48px', marginBottom: '16px' } }, 'ðŸ“š'),
                React.createElement('p', null, 'No tienes mazos'),
                React.createElement('p', { style: { fontSize: '14px', marginTop: '8px' } }, 'Importa desde Moxfield')
              ) :
              decks.map(d => React.createElement('div', { key: d.id, className: 'deck-item' },
                React.createElement('div', { className: 'deck-title' }, d.name),
                React.createElement('div', { className: 'deck-info' }, d.total + ' cartas'),
                React.createElement('div', { className: 'flex' },
                  React.createElement('button', {
                    className: 'button button-danger',
                    style: { flex: 1 },
                    onClick: () => deleteDeck(d.id)
                  }, 'Eliminar'),
                  React.createElement('button', {
                    className: 'button',
                    style: { flex: 2 },
                    onClick: () => startGame(d)
                  }, 'â–¶ Jugar')
                )
              ))
          ),
          showImport && React.createElement('div', { className: 'modal' },
            React.createElement('div', { className: 'modal-content' },
              React.createElement('div', { className: 'modal-header' },
                React.createElement('h2', null, 'Importar Mazo'),
                React.createElement('button', {
                  className: 'icon-btn',
                  onClick: () => setShowImport(false)
                }, 'Ã—')
              ),
              React.createElement('div', { className: 'modal-body' },
                React.createElement('p', { style: { marginBottom: '12px', color: '#c4b5fd' } },
                  'Pega el texto de Moxfield:'
                ),
                React.createElement('textarea', {
                  value: importText,
                  onChange: (e) => setImportText(e.target.value),
                  placeholder: 'Deck:\\nMi Mazo\\n\\n1 Sol Ring\\n1 Command Tower\\n...'
                }),
                error && React.createElement('div', { className: 'error' }, error)
              ),
              React.createElement('div', { className: 'modal-footer' },
                React.createElement('button', {
                  className: 'button button-secondary',
                  style: { flex: 1 },
                  onClick: () => setShowImport(false)
                }, 'Cancelar'),
                React.createElement('button', {
                  className: 'button',
                  style: { flex: 1 },
                  onClick: importDeck
                }, 'Importar')
              )
            )
          )
        );
      }

      // GAME VIEW
      if (view === 'game' && game) {
        const me = game.players[0];
        return React.createElement('div', null,
          React.createElement('div', { className: 'toolbar' },
            React.createElement('button', {
              className: 'back-btn',
              onClick: () => {
                if (confirm('Â¿Salir?')) {
                  setView('home');
                  setGame(null);
                }
              }
            }, 'â†'),
            React.createElement('div', { className: 'toolbar-title' }, 'Partida - Turno ' + game.turn)
          ),
          React.createElement('div', { className: 'container' },
            game.players.map(p => React.createElement('div', {
              key: p.id,
              className: 'player-card',
              style: { borderColor: p.color }
            },
              React.createElement('div', { className: 'flex-between' },
                React.createElement('h3', null, p.name),
                p.id === me.id && React.createElement('span', {
                  style: {
                    background: 'rgba(139, 92, 246, 0.3)',
                    padding: '4px 12px',
                    borderRadius: '12px',
                    fontSize: '12px'
                  }
                }, 'TÃº')
              ),
              React.createElement('div', { className: 'life-counter', style: { color: p.life > 20 ? '#10b981' : p.life > 10 ? '#f59e0b' : '#ef4444' } }, p.life),
              React.createElement('div', { style: { marginBottom: '12px' } },
                React.createElement('label', { className: 'label' }, 'â¤ï¸ Vida')
              ),
              p.id === me.id && React.createElement('div', { className: 'counter-buttons' },
                React.createElement('button', {
                  className: 'counter-btn btn-minus',
                  onClick: () => updateLife(p.id, -10)
                }, '-10'),
                React.createElement('button', {
                  className: 'counter-btn btn-minus',
                  onClick: () => updateLife(p.id, -1)
                }, '-1'),
                React.createElement('button', {
                  className: 'counter-btn btn-plus',
                  onClick: () => updateLife(p.id, 1)
                }, '+1'),
                React.createElement('button', {
                  className: 'counter-btn btn-plus',
                  onClick: () => updateLife(p.id, 10)
                }, '+10')
              )
            ))
          )
        );
      }

      return null;
    }

    createRoot(document.getElementById('app')).render(React.createElement(App));
  </script>

</body>
</html>
